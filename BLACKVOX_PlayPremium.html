<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLACKVOX Playlist App</title>
</head>
<body>
    <!-- Login com Spotify -->
    <div>
        <h3>Login com Spotify</h3>
        <button id="spotifyLoginButton">Login com Spotify</button>
    </div>

    <!-- Buscar faixa no Spotify -->
    <div>
        <h3>Buscar Faixa no Spotify</h3>
        <input type="text" id="trackSearch" placeholder="Nome da Faixa">
        <button id="searchTrackButton">Buscar</button>
    </div>
    <div id="trackResults"></div>

    <!-- Criar Playlist -->
    <div>
        <h3>Criar Playlist</h3>
        <input type="file" id="audioInput">
        <button id="addAudioButton">Adicionar</button>
    </div>
    <ul id="audioList"></ul>

    <!-- Salvar Playlist -->
    <div>
        <h3>Salvar Playlist</h3>
        <input type="text" id="playlistName" placeholder="Nome da Playlist">
        <button id="savePlaylistButton">Salvar</button>
    </div>

    <!-- Carregar Playlist -->
    <div>
        <h3>Carregar Playlist</h3>
        <input type="file" id="loadPlaylistInput">
        <button id="loadPlaylistButton">Carregar</button>
    </div>

    <!-- Importar Playlist do Arquivo -->
    <div>
        <h3>Importar Playlist</h3>
        <input type="file" id="importPlaylistInput">
        <button id="importPlaylistButton">Importar</button>
        <button id="removeCurrentPlaylistButton">Remover Playlist Atual</button>
    </div>

    <!-- Buscar Playlists do Usuário -->
    <div>
        <h3>Buscar Playlists do Usuário</h3>
        <input type="text" id="userId" placeholder="ID do Usuário">
        <button id="fetchUserPlaylistsButton">Buscar</button>
    </div>
    <div id="userPlaylists"></div>

    <!-- Buscar Informações do Artista -->
    <div>
        <h3>Buscar Informações do Artista</h3>
        <input type="text" id="artistName" placeholder="Nome do Artista">
        <button id="fetchArtistInfoButton">Buscar</button>
    </div>
    <div id="artistInfo"></div>

    <script>
        let audioList = [];
        let currentAudioIndex = -1;
        let nowPlaying = new Audio();
        let accessToken = ''; // Defina o token de acesso aqui após o login com Spotify

        // Adicionar Faixa
        document.getElementById('addAudioButton').addEventListener('click', addAudio);
        function addAudio() {
            const audioInput = document.getElementById("audioInput");
            const file = audioInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const audio = { url: e.target.result, name: file.name };
                    audioList.push(audio);
                    displayAudioList();
                };
                reader.readAsDataURL(file);
            }
        }

        function displayAudioList() {
            const audioListElement = document.getElementById("audioList");
            audioListElement.innerHTML = "";
            audioList.forEach((audio, index) => {
                const li = document.createElement("li");
                li.innerHTML = `
                    <input type="text" value="${audio.name}" onchange="renameAudio(${index}, this.value)">
                    <div>
                        <button onclick="playAudio(${index})">Tocar</button>
                        <button onclick="removeAudio(${index})">Remover</button>
                    </div>
                `;
                audioListElement.appendChild(li);
            });
        }

        function renameAudio(index, newName) {
            audioList[index].name = newName;
        }

        function removeAudio(index) {
            audioList.splice(index, 1);
            displayAudioList();
        }

        function playAudio(index) {
            if (index >= 0 && index < audioList.length) {
                currentAudioIndex = index;
                const audio = audioList[index];
                nowPlaying.src = audio.url;
                nowPlaying.play();
                updateTimeline();
            }
        }

        nowPlaying.addEventListener('ended', () => {
            currentAudioIndex++;
            if (currentAudioIndex < audioList.length) {
                playAudio(currentAudioIndex);
            } else {
                currentAudioIndex = -1;
            }
        });

        function updateTimeline() {
            const timeline = document.getElementById("timeline");
            if (timeline) {
                clearInterval(timeline.interval);
                timeline.interval = setInterval(() => {
                    const currentTime = nowPlaying.currentTime;
                    const duration = nowPlaying.duration;
                    const progress = (currentTime / duration) * 100;
                    timeline.value = progress;
                }, 1000);
            }
        }

        // Salvar Playlist
        document.getElementById('savePlaylistButton').addEventListener('click', savePlaylist);
        function savePlaylist() {
            const playlistName = document.getElementById("playlistName").value;
            if (!playlistName) {
                alert("Por favor, insira um nome para a playlist.");
                return;
            }
            if (audioList.length === 0) {
                alert("Por favor, adicione faixas à playlist antes de salvar.");
                return;
            }

            const playlist = {
                name: playlistName,
                tracks: audioList
            };

            const blob = new Blob([JSON.stringify(playlist)], { type: "application/json" });
            const url = URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = url;
            a.download = `${playlistName}.json`;
            a.click();
            URL.revokeObjectURL(url);

            alert("Playlist salva com sucesso!");
        }

        // Carregar Playlist
        document.getElementById('loadPlaylistButton').addEventListener('click', loadPlaylist);
        function loadPlaylist() {
            const input = document.getElementById("loadPlaylistInput");
            const file = input.files[0];
            if (!file) {
                alert("Por favor, escolha um arquivo de playlist para carregar.");
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const playlist = JSON.parse(e.target.result);
                    audioList = playlist.tracks;
                    displayAudioList();
                    alert(`Playlist "${playlist.name}" carregada com sucesso!`);
                } catch (error) {
                    alert("Erro ao carregar a playlist. Por favor, verifique o formato do arquivo.");
                }
            };
            reader.readAsText(file);
        }

        // Importar Playlist
        document.getElementById('importPlaylistButton').addEventListener('click', importPlaylist);
        document.getElementById('removeCurrentPlaylistButton').addEventListener('click', removeCurrentPlaylist);
        function importPlaylist() {
            const input = document.getElementById("importPlaylistInput");
            const file = input.files[0];
            if (!file) {
                alert("Por favor, escolha um arquivo de playlist para importar.");
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const playlist = JSON.parse(e.target.result);
                    audioList = playlist.tracks;
                    displayAudioList();
                    alert(`Playlist "${playlist.name}" importada com sucesso!`);
                } catch (error) {
                    alert("Erro ao importar a playlist. Por favor, verifique o formato do arquivo.");
                }
            };
            reader.readAsText(file);
        }

        function removeCurrentPlaylist() {
            if (audioList.length > 0 && confirm("Tem certeza de que deseja remover a playlist atual?")) {
                audioList = [];
                displayAudioList();
                alert("Playlist atual removida.");
            }
        }

        // Buscar Playlists do Usuário
        document.getElementById('fetchUserPlaylistsButton').addEventListener('click', fetchUserPlaylists);
        async function fetchUserPlaylists() {
            const userId = document.getElementById("userId").value;
            if (!userId) {
                alert("Por favor, insira o ID do usuário.");
                return;
            }

            const response = await fetch(`/get_user_playlists?access_token=${accessToken}&user_id=${userId}`);
            if (response.ok) {
                const playlists = await response.json();
                const playlistsDiv = document.getElementById("userPlaylists");
                playlistsDiv.innerHTML = '';
                playlists.items.forEach(playlist => {
                    const playlistDiv = document.createElement("div");
                    playlistDiv.innerText = `${playlist.name} - ${playlist.tracks.total} faixas`;
                    playlistsDiv.appendChild(playlistDiv);
                });
            } else {
                console.error('Erro ao buscar playlists do usuário:', response.statusText);
            }
        }

        // Buscar Informações do Artista
        document.getElementById('fetchArtistInfoButton').addEventListener('click', fetchArtistInfo);
        async function fetchArtistInfo() {
            const artistName = document.getElementById("artistName").value;
            if (!artistName) {
                alert("Por favor, insira o nome do artista.");
                return;
            }

            const response = await fetch(`/get_artist_info?access_token=${accessToken}&artist_name=${encodeURIComponent(artistName)}`);
            if (response.ok) {
                const artistInfo = await response.json();
                const artistInfoDiv = document.getElementById("artistInfo");
                artistInfoDiv.innerHTML = `
                    <h4>${artistInfo.name}</h4>
                    <p>${artistInfo.genres.join(', ')}</p>
                    <p>Seguidores: ${artistInfo.followers.total}</p>
                `;
            } else {
                console.error('Erro ao buscar informações do artista:', response.statusText);
            }
        }
    </script>

    README.md
# BLACKVOX Playlists

## Descrição
O aplicativo BLACKVOX permite criar, salvar, carregar e gerenciar playlists de áudio.
 
Também é possível buscar informações de artistas e playlists de usuários no Spotify.

## Funcionalidades
- Login com Spotify
- Adicionar Áudio
- Buscar Informações do Artista
- Buscar Playlists do Usuário
- Salvar Playlist
- Carregar Playlists
- Importar Playlists de Arquivo
- Remover Playlist Atual

## Como Usar
1. Faça login com sua conta Spotify.
2. Adicione áudios através do botão "Adicionar Áudio".
3. Busque informações de artistas e playlists de usuários no Spotify.
4. Crie e salve suas playlists.
5. Carregue playlists existentes e importe playlists de arquivo.
6. Remova a playlist atual se necessário.

## Tecnologias Utilizadas
- HTML
- CSS
- JavaScript
- Spotify API

## Autor
Jorge Luis Aparecido Matheus
@jorgelamatheus
São Paulo - SP - Brasil
2024
        
</body>
</html>





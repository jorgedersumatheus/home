<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>R√°dio V O V ‚Äî Vinheta + Player</title>
<meta name="color-scheme" content="dark light" />
<style>
  :root{
    --bg:#0b0f16; --panel:#111726; --text:#e8eefc; --muted:#a9b7d3;
    --brand:#1dd4ff; --brand2:#00ffa8; --accent:#ffd94a; --danger:#ff6b6b;
    --card:#0f1524; --edge:rgba(255,255,255,.08);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:radial-gradient(1200px 600px at 70% -10%,rgba(29,212,255,.08),transparent) ,
                      radial-gradient(900px 500px at 10% 120%,rgba(0,255,168,.06),transparent),
                      var(--bg);
    color:var(--text); font:500 16px/1.45 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  }
  header{display:flex; gap:12px; align-items:center; padding:20px 18px 10px}
  .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(135deg,var(--brand),var(--brand2));box-shadow:0 0 18px rgba(29,212,255,.8)}
  h1{font-size:20px;margin:0;font-weight:800;letter-spacing:.4px}
  .sub{color:var(--muted);font-size:14px;margin:2px 18px 14px}

  /* bloco vinheta */
  .stage{max-width:980px;margin:0 auto;padding:10px 18px 26px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02)); 
        border:1px solid var(--edge); border-radius:18px; box-shadow:0 10px 40px rgba(0,0,0,.35)}
  #vinhetaWrap{position:relative; overflow:hidden}
  video{width:100%; display:block; background:#000; border-radius:18px}
  .overlay{
    position:absolute; inset:0; display:flex; gap:10px; align-items:end; justify-content:space-between;
    padding:14px; background:linear-gradient(180deg,transparent 40%,rgba(0,0,0,.45));
  }
  .row{display:flex;gap:10px;align-items:center}
  .btn{
    appearance:none; border:1px solid var(--edge); background:linear-gradient(180deg,#172035,#0f1626);
    color:var(--text); padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer;
    box-shadow:0 6px 20px rgba(0,0,0,.25); transition:transform .08s ease, background .2s ease, border .2s ease;
  }
  .btn:hover{transform:translateY(-1px); border-color:rgba(255,255,255,.18)}
  .btn.brand{background:linear-gradient(180deg,rgba(29,212,255,.18),rgba(0,255,168,.18)); border-color:rgba(29,212,255,.35)}
  .btn.warn{background:linear-gradient(180deg,#2a210b,#1c1608); border-color:rgba(255,217,74,.4); color:#ffe9a3}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip{font-size:12px; color:#02131a; background:linear-gradient(135deg,var(--brand),var(--brand2));
        padding:6px 10px; border-radius:999px; font-weight:800; letter-spacing:.2px}

  /* player embutido */
  #player{display:none; margin-top:18px; padding:18px}
  .grid{display:grid; grid-template-columns:1.1fr .9fr; gap:18px}
  @media (max-width:840px){ .grid{grid-template-columns:1fr} }
  .panel{background:linear-gradient(180deg,#0e1526,#0c1220); border:1px solid var(--edge); border-radius:16px; padding:14px}
  .panel h2{margin:0 0 8px; font-size:16px; letter-spacing:.3px}
  .tracks{max-height:300px; overflow:auto; margin-top:8px}
  .track{display:flex;align-items:center;justify-content:space-between;gap:10px;
         padding:10px 12px; border:1px solid var(--edge); border-radius:12px; background:var(--card); margin-bottom:10px}
  .tname{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .icons button{border:0;background:#121a2d;color:#dfe9ff;border:1px solid var(--edge);border-radius:10px;
                width:36px;height:36px;display:grid;place-items:center;cursor:pointer}
  .icons button:hover{border-color:rgba(255,255,255,.2)}
  .meta{color:var(--muted); font-size:13px; margin-top:8px}
  audio{width:100%; margin-top:8px}

  /* links externos */
  .links{display:flex; gap:10px; flex-wrap:wrap}
  .a{ text-decoration:none }
  .cta{
    display:inline-flex; align-items:center; gap:10px; padding:12px 14px; border-radius:14px; 
    border:1px solid var(--edge); background:linear-gradient(180deg,#141c2f,#0e1526); color:var(--text); font-weight:800
  }
  .cta:hover{border-color:rgba(255,255,255,.2)}
  footer{max-width:980px;margin:26px auto 40px;color:var(--muted);font-size:13px;padding:0 18px}
</style>
</head>
<body>
  <header>
    <span class="dot"></span><h1>R√°dio V O V</h1>
  </header>
  <div class="sub">Vinheta na abertura ‚Ä¢ depois o player entra autom√°tico ‚Ä¢ ‚Äúa m√∫sica n√£o pode parar‚Äù.</div>

  <main class="stage">
    <!-- VINHETA -->
    <section id="vinhetaWrap" class="card">
      <video id="vinheta" autoplay muted playsinline preload="auto" poster="/vov/poster_radio.jpg">
        <source src="/vov/Vinheta_RV.mp4" type="video/mp4">
      </video>
      <div class="overlay">
        <div class="chips">
          <span class="chip">VOV</span><span class="chip">Abertura Oficial</span><span class="chip">Som On</span>
        </div>
        <div class="row">
          <button id="btnSom" class="btn brand" aria-pressed="false">üîä Ativar som</button>
          <button id="btnSkip" class="btn warn">‚è≠Ô∏è Pular vinheta</button>
        </div>
      </div>
    </section>

    <!-- PLAYER -->
    <section id="player" class="card">
      <div class="grid">
        <div class="panel">
          <h2>Player VOV (embutido)</h2>
          <input type="file" id="pick" accept="audio/*" multiple class="btn" />
          <div class="meta">Dica: voc√™ pode <b>arrastar MP3</b> para esta √°rea.</div>
          <div id="tracks" class="tracks"></div>
          <div class="meta" id="now">‚Äî</div>
          <audio id="audio" controls></audio>
        </div>

        <div class="panel">
          <h2>Abrir em p√°ginas dedicadas</h2>
          <div class="links" style="margin-top:8px">
            <a class="a" href="/vov/vov_players.html" target="_blank">
              <span class="cta">üéöÔ∏è Cl√°ssico (p√°gina)</span>
            </a>
            <a class="a" href="/vov/vov_mini_colorido.html" target="_blank">
              <span class="cta">üéõÔ∏è Mini (p√°gina)</span>
            </a>
          </div>
          <hr style="border:none;border-top:1px solid var(--edge);margin:14px 0">
          <label style="display:flex;align-items:center;gap:10px">
            <input type="checkbox" id="hora" />
            Repetir vinheta no topo de cada hora
          </label>
          <div class="meta">Quando ativo, a vinheta pausa o player e volta sozinho ao fim.</div>
        </div>
      </div>
    </section>
  </main>

  <footer>¬© 2025 V O V ‚Äî Ver ‚Ä¢ Ouvir ‚Ä¢ Vender ‚Ä¢ Viver</footer>

<script>
  // --- VINHETA ---
  const vinheta = document.getElementById('vinheta');
  const wrap    = document.getElementById('vinhetaWrap');
  const btnSom  = document.getElementById('btnSom');
  const btnSkip = document.getElementById('btnSkip');
  const player  = document.getElementById('player');

  // em iOS/Android, autoplay com som exige gesto. Mantemos muted e oferecemos "ativar som".
  btnSom.addEventListener('click', () => {
    vinheta.muted = !vinheta.muted;
    btnSom.textContent = vinheta.muted ? 'üîä Ativar som' : 'üîà Silenciar vinheta';
    btnSom.setAttribute('aria-pressed', String(!vinheta.muted));
    if (vinheta.paused) vinheta.play().catch(()=>{});
  });

  function entrarNoAr(){
    wrap.style.display = 'none';
    player.style.display = 'block';
    // foca no bot√£o de escolher arquivos para facilitar no mobile
    document.getElementById('pick').focus({preventScroll:true});
  }
  vinheta.addEventListener('ended', entrarNoAr);
  btnSkip.addEventListener('click', entrarNoAr);

  // --- PLAYER EMBUTIDO (simples, com auto-avan√ßar e drag&drop) ---
  const pick   = document.getElementById('pick');
  const listEl = document.getElementById('tracks');
  const audio  = document.getElementById('audio');
  const nowEl  = document.getElementById('now');

  /** estado */
  let queue = []; // {name, url}
  let idx   = -1;

  // escolher arquivos
  pick.addEventListener('change', async (e)=>{
    await addFiles(e.target.files);
  });

  // drag & drop
  ['dragenter','dragover'].forEach(ev=>{
    player.addEventListener(ev, e=>{ e.preventDefault(); e.dataTransfer.dropEffect='copy'; player.style.outline='2px dashed #28e1ff';});
  });
  ['dragleave','drop'].forEach(ev=>{
    player.addEventListener(ev, e=>{ e.preventDefault(); player.style.outline='none';});
  });
  player.addEventListener('drop', async (e)=>{
    await addFiles(e.dataTransfer.files);
  });

  async function addFiles(fileList){
    const files = [...fileList].filter(f=>/^audio\//.test(f.type) || /\.mp3$/i.test(f.name));
    for (const f of files){
      const url = URL.createObjectURL(f);
      queue.push({name:f.name, url});
    }
    render();
    if (idx === -1 && queue.length) playAt(0);
  }

  function render(){
    listEl.innerHTML = '';
    queue.forEach((t,i)=>{
      const row = document.createElement('div');
      row.className = 'track';
      row.innerHTML = `
        <div class="tname">${i===idx ? '‚ñ∂Ô∏è ' : ''}${t.name}</div>
        <div class="icons">
          <button title="Tocar"   onclick="playAt(${i})">‚ñ∂</button>
          <button title="Subir"   onclick="moveUp(${i})">‚Üë</button>
          <button title="Descer"  onclick="moveDown(${i})">‚Üì</button>
          <button title="Remover" onclick="removeAt(${i})">√ó</button>
        </div>`;
      listEl.appendChild(row);
    });
  }

  window.playAt = function(i){
    idx = i;
    const t = queue[i];
    if (!t) return;
    audio.src = t.url;
    nowEl.textContent = 'Tocando agora: ' + t.name;
    audio.play().catch(()=>{});
    render();
  }
  window.moveUp = function(i){
    if (i<=0) return;
    [queue[i-1], queue[i]] = [queue[i], queue[i-1]];
    if (idx===i) idx=i-1; else if (idx===i-1) idx=i;
    render();
  }
  window.moveDown = function(i){
    if (i>=queue.length-1) return;
    [queue[i+1], queue[i]] = [queue[i], queue[i+1]];
    if (idx===i) idx=i+1; else if (idx===i+1) idx=i;
    render();
  }
  window.removeAt = function(i){
    const was = (i===idx);
    queue.splice(i,1);
    if (queue.length===0){ audio.pause(); audio.removeAttribute('src'); idx=-1; nowEl.textContent='‚Äî'; }
    else if (was){ idx = i>=queue.length ? queue.length-1 : i; playAt(idx); }
    render();
  }

  // auto-avan√ßar
  audio.addEventListener('ended', ()=>{
    if (idx < queue.length-1) playAt(idx+1);
    else { idx = -1; render(); nowEl.textContent='‚Äî'; } // fim da fila
  });

  // --- Vinheta de hora cheia ---
  const chkHora = document.getElementById('hora');
  let timerHora = null;

  function scheduleTopOfHour(){
    clearTimeout(timerHora);
    const now = new Date();
    const msToNext = (60 - now.getMinutes())*60*1000 - now.getSeconds()*1000 - now.getMilliseconds();
    timerHora = setTimeout(()=>{
      tocarVinhetaTopoHora();
      scheduleTopOfHour(); // agenda a pr√≥xima
    }, Math.max(1000, msToNext));
  }

  async function tocarVinhetaTopoHora(){
    // pausa player, mostra video s√≥ com fade
    const wasPlaying = !audio.paused;
    audio.pause();
    wrap.style.display='block';
    vinheta.currentTime = 0;
    vinheta.muted = false; // na hora cheia, tentamos com som (poder√° exigir gesto em alguns mobiles)
    try{ await vinheta.play(); }catch(e){}
    vinheta.onended = ()=>{
      wrap.style.display='none';
      if (wasPlaying) audio.play().catch(()=>{});
      // restaura handler padr√£o de primeira carga
      vinheta.onended = entrarNoAr;
    };
  }

  chkHora.addEventListener('change', (e)=>{
    if (e.target.checked) scheduleTopOfHour();
    else clearTimeout(timerHora);
  });
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BLACKVOX • Campeão (V O V)</title>
<meta name="description" content="BLACKVOX Campeão — criar, importar, exportar e tocar playlists com a pegada V O V." />
<link rel="icon" href="/vov/favicon.ico">
<style>
  :root{
    --bg:#0b0e12; --panel:#12161d; --muted:#9aa4b5; --text:#e9eef7; --brand:#00d4ff; --brand2:#7c5cff; --accent:#17ff88; --danger:#ff4d4d;
    --card:#0f1319; --stroke:#1e2430; --ink:#0c1117;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text); background:
      radial-gradient(1200px 650px at 10% -10%, rgba(124,92,255,.08), transparent 60%),
      radial-gradient(1000px 500px at 110% 10%, rgba(0,212,255,.08), transparent 60%),
      var(--bg);
    font: 15px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans";
    -webkit-tap-highlight-color: transparent;
  }
  a{color:var(--brand); text-decoration:none}
  a:hover{text-decoration:underline}

  /* header */
  .topbar{
    position:sticky; top:0; z-index:50;
    backdrop-filter:saturate(140%) blur(8px);
    background:linear-gradient(180deg, rgba(11,14,18,.9), rgba(11,14,18,.6));
    border-bottom:1px solid var(--stroke);
  }
  .topwrap{max-width:1100px; margin:0 auto; padding:14px 16px; display:flex; gap:14px; align-items:center; justify-content:space-between}
  .brand{display:flex; align-items:center; gap:12px}
  .pill{
    background:linear-gradient(135deg, var(--brand), var(--brand2));
    color:#001018; font-weight:900; letter-spacing:.5px;
    padding:6px 10px; border-radius:10px; font-size:12px;
  }
  .title h1{margin:0; font-weight:800; font-size:16px}
  .title small{display:block; color:var(--muted); font-size:12px; margin-top:2px}

  .navlinks{display:flex; gap:8px; flex-wrap:wrap}
  .btn{
    display:inline-flex; align-items:center; gap:8px; cursor:pointer;
    border:1px solid var(--stroke); border-radius:10px; padding:8px 12px;
    background:linear-gradient(180deg, #0f1319, #0b0e12); color:var(--text);
    transition:.15s transform, .15s border-color, .15s background;
    user-select:none;
  }
  .btn:hover{transform:translateY(-1px); border-color:#2a3345; text-decoration:none}
  .btn.brand{border-color:transparent; background:linear-gradient(135deg, #00d4ff33, #7c5cff33)}
  .btn.danger{border-color:#3a1a1a; background:#1a0f0f; color:#ffb4b4}
  .btn.ghost{background:transparent}
  .btn.small{padding:6px 10px; font-size:13px; border-radius:8px}
  .btn .dot{width:8px; height:8px; border-radius:50%}
  .dot.c1{background:var(--brand)}
  .dot.c2{background:var(--accent)}
  .dot.c3{background:#ffd166}

  /* layout */
  .wrap{max-width:1100px; margin:22px auto 64px; padding:0 16px}
  .grid{display:grid; grid-template-columns: 1.35fr .65fr; gap:22px}
  @media (max-width:980px){ .grid{grid-template-columns:1fr} }

  /* cards */
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.00));
    border:1px solid var(--stroke); border-radius:16px; overflow:hidden;
    box-shadow:0 10px 30px rgba(0,0,0,.25);
  }
  .card > .head{
    padding:16px; border-bottom:1px solid var(--stroke); display:flex; align-items:center; justify-content:space-between
  }
  .card > .head h2{margin:0; font-size:16px; font-weight:800; letter-spacing:.3px}
  .badge{font-size:11px; color:#0b0e12; background:linear-gradient(135deg, var(--brand), var(--accent)); padding:6px 8px; border-radius:999px; font-weight:800}

  /* forms / rows */
  .section{padding:16px; display:grid; gap:12px}
  .row{display:flex; gap:8px; flex-wrap:wrap}
  .row input[type="url"], .row input[type="text"]{
    flex:1 1 240px; min-width:220px; padding:10px 12px; border-radius:10px; border:1px solid var(--stroke);
    background:#0b0f14; color:var(--text); outline:none;
  }
  .row input::placeholder{color:#667089}
  .row .btn{white-space:nowrap}

  .hint{color:var(--muted); font-size:12px; margin-top:-4px}

  /* controls */
  .controls{display:flex; gap:8px; flex-wrap:wrap}
  .btn-ctrl{
    border:1px solid var(--stroke); background:#0e131a; color:var(--text);
    border-radius:10px; padding:8px 12px; font-size:13px; cursor:pointer;
  }
  .btn-ctrl.active{border-color:var(--brand); box-shadow:0 0 0 2px rgba(0,212,255,.2) inset}

  .now{margin:6px 0 6px; font-size:13px; color:var(--muted)}
  .now b{color:var(--text)}
  .progress{height:8px; background:#121720; border:1px solid var(--stroke); border-radius:999px; overflow:hidden; margin:4px 0 12px}
  .bar{height:100%; width:0%; background:linear-gradient(90deg, var(--brand), var(--accent)); transition:width .15s}

  /* playlist list */
  ul.play{list-style:none; margin:0; padding:0}
  ul.play li{
    display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center;
    padding:10px 12px; border:1px solid var(--stroke); border-radius:12px; margin-bottom:8px; background:#0b0f14;
  }
  ul.play li.active{outline:2px solid rgba(0,212,255,.25)}
  .track-title{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .rowbtns{display:flex; gap:6px}
  .rowbtns button{
    border:1px solid var(--stroke); background:#0f1319; color:var(--text); padding:6px 8px; border-radius:8px; font-size:12px; cursor:pointer;
  }
  .rowbtns button.rm{border-color:#2e1b1b; background:#170f10; color:#ff9b9b}

  /* sidebar */
  .side{display:grid; gap:16px; align-content:start}
  .panel{background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)); border:1px solid var(--stroke); border-radius:16px; padding:16px}
  .panel h3{margin:0 0 8px; font-size:14px; letter-spacing:.2px}
  .panel p{margin:0 10px 10px 0; color:var(--muted); font-size:13px}
  .list a{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px 12px; border:1px solid var(--stroke); border-radius:12px; background:#0b0f14; text-decoration:none}
  .list a:hover{border-color:#2a3345}
  .tag{font-size:11px; color:#001018; background:linear-gradient(135deg, var(--brand), var(--brand2)); padding:5px 8px; border-radius:999px; font-weight:800}

  footer{margin:40px 0 80px; color:var(--muted); font-size:12px; text-align:center}
  footer a{color:var(--muted)}

  /* impedir sobreposição de elementos */
  .no-overlap{position:relative; z-index:2}
  input, button, label{z-index:2; position:relative}
</style>
</head>
<body>

<header class="topbar">
  <div class="topwrap">
    <div class="brand">
      <div class="pill">V O V</div>
      <div class="title">
        <h1>BLACKVOX • Campeão</h1>
        <small>Criar • Importar • Exportar • Salvar & Carregar</small>
      </div>
    </div>
    <nav class="navlinks">
      <a class="btn" href="/vov/index.html"><span class="dot c1"></span> Início</a>
      <a class="btn" href="/vov/edicoes.html"><span class="dot c2"></span> Arquivo</a>
      <a class="btn ghost" href="/vov/vov_players.html"><span class="dot c3"></span> Clássico</a>
      <a class="btn ghost" href="/vov/vov_mini_colorido.html">Mini</a>
    </nav>
  </div>
</header>

<div class="wrap">
  <div class="grid">
    <section class="card">
      <div class="head">
        <h2>Editor de Playlists</h2>
        <span class="badge">V O V</span>
      </div>

      <div class="section no-overlap">
        <!-- Nome da playlist -->
        <div class="row">
          <input id="playlistName" type="text" placeholder="Nome da playlist (ex.: VOV Jazz Solar)" />
          <button class="btn small brand" id="btnNew">Nova</button>
          <button class="btn small" id="btnSaveLocal">Salvar (navegador)</button>
          <button class="btn small" id="btnLoadLocal">Carregar salvas</button>
        </div>

        <!-- Importar / Exportar -->
        <div class="row">
          <input id="jsonUrl" type="url" placeholder="Carregar por URL de JSON público" />
          <button class="btn small" id="btnLoadUrl">Carregar URL</button>

          <input id="jsonFile" type="file" accept="application/json" style="display:none">
          <button class="btn small" id="btnLoadFile">Importar JSON</button>

          <button class="btn small" id="btnExport">Exportar JSON</button>
        </div>
        <div class="hint">Formato esperado: <code>[{"name":"Faixa ...","url":"https://.../arquivo.mp3"}, ...]</code></div>

        <!-- Adicionar faixa -->
        <div class="row">
          <input id="trackName" type="text" placeholder="Nome da faixa" />
          <input id="trackUrl" type="url" placeholder="URL da faixa (mp3/ogg)" />
          <button class="btn small" id="btnAdd">Adicionar</button>

          <input id="trackFile" type="file" accept="audio/*" style="display:none" />
          <button class="btn small" id="btnAddFile">+ Arquivo</button>
        </div>

        <!-- Controles -->
        <div class="controls">
          <button class="btn-ctrl" id="btnPrev">◂ Anterior</button>
          <button class="btn-ctrl" id="btnPlayPause">▶︎ Reproduzir</button>
          <button class="btn-ctrl" id="btnNext">Próxima ▸</button>
          <button class="btn-ctrl" id="btnShuffle">Shuffle</button>
          <button class="btn-ctrl" id="btnLoop">Loop</button>
          <button class="btn-ctrl danger" id="btnClear">Limpar lista</button>
        </div>

        <div class="now">Tocando agora: <b id="nowTitle">—</b></div>
        <div class="progress"><div class="bar" id="bar"></div></div>

        <ul class="play" id="playList"></ul>

        <audio id="player" preload="metadata" crossorigin="anonymous"></audio>
      </div>
    </section>

    <aside class="side">
      <div class="panel">
        <h3>Outros players</h3>
        <div class="list"><a href="/vov/vov_players.html">Clássico <span class="tag">Rádio</span></a></div>
        <div class="list" style="margin-top:8px"><a href="/vov/vov_mini.html">Mini <span class="tag">Leve</span></a></div>
      </div>

      <div class="panel">
        <h3>Dicas VOV</h3>
        <p>Para links públicos, prefira hospedar MP3/OGG em Drive com link direto, CDN ou no seu servidor. Em celular, Wi-Fi ajuda em streams longos.</p>
        <p>Arquivos locais viram <em>data URL</em> (funciona, mas não compartilha). Para compartilhar, exporte JSON e troque as URLs para links públicos.</p>
      </div>

      <div class="panel">
        <h3>Atalhos</h3>
        <div class="list"><a href="/vov/edicoes.html">Arquivo do JOR NEWS VOV <span class="tag">PDF</span></a></div>
        <div class="list" style="margin-top:8px"><a href="/vov/contato.html">Fale com a VOV <span class="tag">Contato</span></a></div>
      </div>
    </aside>
  </div>
</div>

<footer>
  V O V — Ver, Ouvir, Vender, Viver • Salvador • Amaralina • Brasil<br/>
  Coautoria: Jorge LA Matheus & AxéBit • <a href="/vov/index.html">Início</a>
</footer>

<script>
(function(){
  // ===== Estado =====
  const player = document.getElementById('player');
  const listEl = document.getElementById('playList');
  const nowEl  = document.getElementById('nowTitle');
  const barEl  = document.getElementById('bar');

  const nameI   = document.getElementById('playlistName');

  const btnNew  = document.getElementById('btnNew');
  const btnSave = document.getElementById('btnSaveLocal');
  const btnLoad = document.getElementById('btnLoadLocal');

  const urlI    = document.getElementById('jsonUrl');
  const btnUrl  = document.getElementById('btnLoadUrl');

  const fileJson= document.getElementById('jsonFile');
  const btnImp  = document.getElementById('btnLoadFile');
  const btnExp  = document.getElementById('btnExport');

  const trkName = document.getElementById('trackName');
  const trkUrl  = document.getElementById('trackUrl');
  const btnAdd  = document.getElementById('btnAdd');
  const fileAud = document.getElementById('trackFile');
  const btnAddF = document.getElementById('btnAddFile');

  const btnPrev = document.getElementById('btnPrev');
  const btnPlay = document.getElementById('btnPlayPause');
  const btnNext = document.getElementById('btnNext');
  const btnLoop = document.getElementById('btnLoop');
  const btnShuf = document.getElementById('btnShuffle');
  const btnClear= document.getElementById('btnClear');

  let tracks = [];     // [{name,url}]
  let index  = -1;
  let loopOn = false;
  let shuffleOn = false;

  // ===== UI helpers =====
  function render(){
    listEl.innerHTML = '';
    tracks.forEach((t, i)=>{
      const li = document.createElement('li');
      if(i===index) li.classList.add('active');

      const title = document.createElement('div');
      title.className='track-title';
      title.textContent = t.name || t.url;

      const btns = document.createElement('div');
      btns.className='rowbtns';

      const bPlay = document.createElement('button');
      bPlay.textContent = '▶︎'; bPlay.title='Tocar';
      bPlay.addEventListener('click', ()=> playAt(i), {passive:true});

      const bUp = document.createElement('button');
      bUp.textContent = '↑'; bUp.title='Subir';
      bUp.addEventListener('click', ()=> move(i, -1), {passive:true});

      const bDown = document.createElement('button');
      bDown.textContent = '↓'; bDown.title='Descer';
      bDown.addEventListener('click', ()=> move(i, +1), {passive:true});

      const bRm = document.createElement('button');
      bRm.textContent = '×'; bRm.title='Remover'; bRm.className='rm';
      bRm.addEventListener('click', ()=> removeAt(i), {passive:true});

      btns.append(bPlay, bUp, bDown, bRm);
      li.append(title, btns);
      listEl.append(li);
    });
    nowEl.textContent = (tracks[index]?.name) || '—';
  }

  function playAt(i){
    if(!tracks[i]) return;
    index = i;
    player.src = tracks[i].url;
    player.play().catch(()=>{ /* bloqueio de autoplay no mobile */ });
    btnPlay.textContent='⏸ Pausar';
    render();
  }
  function next(){
    if(!tracks.length) return;
    if(shuffleOn && tracks.length>1){
      let j=index; while(j===index) j=Math.floor(Math.random()*tracks.length);
      playAt(j); return;
    }
    const j=(index+1)%tracks.length;
    playAt(j);
  }
  function prev(){
    if(!tracks.length) return;
    const j=(index-1+tracks.length)%tracks.length;
    playAt(j);
  }
  function move(i, dir){
    const j=i+dir; if(j<0||j>=tracks.length) return;
    const t=tracks[i]; tracks[i]=tracks[j]; tracks[j]=t;
    if(index===i) index=j; else if(index===j) index=i;
    render();
  }
  function removeAt(i){
    tracks.splice(i,1);
    if(index>=tracks.length) index = tracks.length-1;
    render();
  }
  function addTrack(name,url){
    if(!url) return;
    tracks.push({name:name||url, url});
    if(index===-1) index=0;
    render();
  }

  // ===== Progresso =====
  player.addEventListener('timeupdate', ()=>{
    if(!player.duration || isNaN(player.duration)) return;
    const pct = (player.currentTime / player.duration) * 100;
    barEl.style.width = (pct||0) + '%';
  }, {passive:true});
  player.addEventListener('ended', ()=>{
    if(loopOn){ player.currentTime=0; player.play(); }
    else next();
  });

  // ===== Controles =====
  btnPrev.addEventListener('click', prev, {passive:true});
  btnNext.addEventListener('click', next, {passive:true});
  btnPlay.addEventListener('click', ()=>{
    if(player.paused){ player.play(); btnPlay.textContent='⏸ Pausar'; }
    else { player.pause(); btnPlay.textContent='▶︎ Reproduzir'; }
  });
  btnLoop.addEventListener('click', ()=>{
    loopOn=!loopOn; btnLoop.classList.toggle('active', loopOn);
  });
  btnShuf.addEventListener('click', ()=>{
    shuffleOn=!shuffleOn; btnShuf.classList.toggle('active', shuffleOn);
  });
  btnClear.addEventListener('click', ()=>{
    if(!tracks.length) return;
    if(confirm('Limpar todas as faixas?')){
      tracks=[]; index=-1; render();
    }
  });

  // ===== Nova / Salvar / Carregar (LocalStorage) =====
  const KEY_NS = 'BLACKVOX_VOV_PLAYLISTS';
  function getStore(){
    try{ return JSON.parse(localStorage.getItem(KEY_NS)||'{}'); }
    catch{ return {}; }
  }
  function setStore(obj){
    localStorage.setItem(KEY_NS, JSON.stringify(obj));
  }
  btnNew.addEventListener('click', ()=>{
    tracks=[]; index=-1; render();
    if(!nameI.value.trim()) nameI.value='Minha Playlist';
  });
  btnSave.addEventListener('click', ()=>{
    const nm = nameI.value.trim() || 'Minha Playlist';
    const store = getStore();
    store[nm] = tracks;
    setStore(store);
    alert('Playlist salva no navegador: ' + nm);
  });
  btnLoad.addEventListener('click', ()=>{
    const store = getStore();
    const names = Object.keys(store);
    if(!names.length){ alert('Nenhuma playlist salva encontrada.'); return; }
    const nm = prompt('Qual playlist carregar?\n\n' + names.join('\n'));
    if(!nm || !store[nm]) return;
    nameI.value = nm;
    tracks = store[nm];
    index = tracks.length?0:-1;
    render();
  });

  // ===== Importar / Exportar =====
  btnImp.addEventListener('click', ()=> fileJson.click());
  fileJson.addEventListener('change', async (ev)=>{
    const f = ev.target.files[0]; if(!f) return;
    try{
      const txt = await f.text();
      const data = JSON.parse(txt);
      if(!Array.isArray(data)) throw new Error('JSON não é array.');
      const ok = data.every(it=>it && typeof it.url==='string');
      if(!ok) throw new Error('Itens sem "url".');
      tracks = data.map(it=>({name: it.name || it.title || it.url, url: it.url}));
      index = tracks.length?0:-1;
      render();
    }catch(err){
      alert('Falha ao importar JSON: '+err.message);
    }finally{
      ev.target.value='';
    }
  });

  btnUrl.addEventListener('click', async ()=>{
    const u = urlI.value.trim(); if(!u){ alert('Informe a URL do JSON.'); return; }
    try{
      const res = await fetch(u, {cache:'no-store'});
      if(!res.ok) throw new Error('HTTP '+res.status);
      const data = await res.json();
      if(!Array.isArray(data)) throw new Error('JSON não é array.');
      const ok = data.every(it=>it && typeof it.url==='string');
      if(!ok) throw new Error('Itens sem "url".');
      tracks = data.map(it=>({name: it.name || it.title || it.url, url: it.url}));
      index = tracks.length?0:-1;
      render();
    }catch(err){
      alert('Falha ao carregar URL: '+err.message);
    }
  });

  btnExp.addEventListener('click', ()=>{
    const nm = (nameI.value.trim() || 'playlist').replace(/[^\w\-]+/g,'_');
    const blob = new Blob([JSON.stringify(tracks, null, 2)], {type:'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = nm + '.json';
    document.body.appendChild(a);
    a.click();
    setTimeout(()=>{ URL.revokeObjectURL(a.href); a.remove(); }, 0);
  });

  // ===== Adicionar faixa por URL / Arquivo =====
  btnAdd.addEventListener('click', ()=>{
    const n = trkName.value.trim();
    const u = trkUrl.value.trim();
    if(!u){ alert('Informe a URL da faixa (mp3/ogg).'); return; }
    addTrack(n, u);
    trkName.value=''; trkUrl.value='';
  });

  btnAddF.addEventListener('click', ()=> fileAud.click());
  fileAud.addEventListener('change', async (ev)=>{
    const f = ev.target.files[0]; if(!f) return;
    // para não ficar pesado, usar ObjectURL em vez de dataURL
    const url = URL.createObjectURL(f);
    addTrack(f.name, url);
    ev.target.value='';
  });

  // ===== Estado inicial =====
  render();
})();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BLACKVOX • Campeão (VOV)</title>
<style>
  :root{
    --bg:#05060a;
    --panel:#0a0c12;
    --ink:#eaf6ff;
    --muted:#9bb4c7;
    --brand:#4cc9f0;      /* azul neon */
    --brand-2:#4361ee;    /* azul profundo */
    --accent:#f72585;     /* detalhe */
    --ok:#52ffa8;
    --warn:#ffd166;
    --danger:#ff6b6b;
    --border:#121826;
    --chip:#0f1420;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:
      radial-gradient(1200px 600px at 80% -10%, #0b1530 0%, transparent 60%),
      radial-gradient(900px 500px at -10% 110%, #0b1a26 0%, transparent 60%),
      linear-gradient(180deg, #06070c 0%, #070a11 100%);
    color:var(--ink); font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    letter-spacing:.2px;
  }
  a{color:var(--brand); text-decoration:none}
  a:hover{color:#8be1ff; text-decoration:underline}

  /* Header */
  .topbar{
    position:sticky; top:0; z-index:10;
    backdrop-filter: blur(10px);
    background:rgba(7,10,17,.6);
    border-bottom:1px solid var(--border);
  }
  .topbar .wrap{
    display:flex; align-items:center; justify-content:space-between;
    gap:16px; padding:14px 18px; max-width:1100px; margin:0 auto;
  }
  .brand{
    display:flex; align-items:center; gap:12px; font-weight:700; letter-spacing:.6px;
  }
  .brand .logo{
    width:34px; height:34px; border-radius:10px;
    background:
      conic-gradient(from 210deg at 50% 50%, var(--brand) 0 35%, transparent 35% 100%),
      radial-gradient(100% 100% at 30% 20%, #0ef 0 45%, transparent 46% 100%);
    box-shadow: 0 0 24px rgba(76,201,240,.35), inset 0 0 18px rgba(67,97,238,.25);
  }
  .brand .title{font-size:15px; color:#cfe8ff}
  .brand .title b{color:#fff}

  .nav{
    display:flex; gap:10px; flex-wrap:wrap;
  }
  .nav a{
    padding:8px 12px; border:1px solid var(--border);
    background: #0b0f18; border-radius:10px; color:#cfe8ff; font-size:13px;
  }
  .nav a:hover{border-color:#18304a; background:#0e1422}

  /* Layout */
  .container{max-width:1100px; margin:26px auto; padding:0 18px}

  .grid{
    display:grid; grid-template-columns: 360px 1fr; gap:18px;
  }
  @media (max-width: 860px){ .grid{grid-template-columns:1fr} }

  /* Panel left (playlist) */
  .panel{
    border:1px solid var(--border); background:var(--panel);
    border-radius:16px; padding:14px; box-shadow: 0 10px 30px rgba(0,0,0,.25);
  }
  .panel h2{margin:4px 0 10px; font-size:16px; color:#e6f2ff; font-weight:700}
  .muted{color:var(--muted); font-size:13px}

  .drop{
    margin:12px 0; padding:12px; border:1px dashed #20324a; border-radius:12px; text-align:center;
    background: linear-gradient(180deg, #0c111b, #0a0e17);
  }
  .drop.drag{border-color:var(--brand); background:#0b1422}
  .drop input{display:none}

  .controls{
    display:flex; flex-wrap:wrap; gap:8px; margin:12px 0 6px;
  }
  .btn{
    appearance:none; border:none; cursor:pointer; font-weight:600;
    padding:9px 12px; font-size:13px; border-radius:10px; color:#001019;
    background:linear-gradient(180deg, #9fe7ff, #5fd0ff);
    box-shadow: 0 4px 14px rgba(79,199,240,.25);
  }
  .btn:hover{filter:brightness(1.08)}
  .btn.ghost{
    background:#0c1320; color:#bfe6ff; border:1px solid #18304a; box-shadow:none;
  }
  .btn.warn{ background:linear-gradient(180deg, #ffe08a, #ffd166); color:#3a2100 }
  .btn.danger{ background:linear-gradient(180deg, #ff9aa4, #ff6b6b); color:#2b0006 }

  .list{
    margin-top:8px; max-height:55vh; overflow:auto; padding-right:4px;
  }
  .row{
    display:grid; grid-template-columns: 1fr auto; gap:8px;
    align-items:center; padding:10px; border-radius:10px;
    background:#0c111a; border:1px solid #121a28; margin-bottom:8px;
  }
  .row.active{ border-color:#254a77; box-shadow: inset 0 0 0 1px #254a77; background:#0b1422 }
  .row .meta{display:flex; align-items:center; gap:10px; min-width:0}
  .row .dot{
    width:8px; height:8px; border-radius:50%;
    background:linear-gradient(180deg, var(--brand), var(--brand-2));
    box-shadow:0 0 12px rgba(76,201,240,.45);
  }
  .row .name{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .row .ops{display:flex; gap:6px}
  .chip{
    padding:6px 8px; border-radius:8px; background:var(--chip);
    border:1px solid #1b2638; color:#d9edff; font-size:12px; cursor:pointer;
  }
  .chip:hover{border-color:#2a3d5e}

  /* Player panel */
  .player{
    border:1px solid var(--border); background:#0a0f18; border-radius:16px; padding:16px;
    min-height:220px; display:flex; flex-direction:column; gap:14px;
  }
  .now{
    display:flex; align-items:center; gap:12px; min-height:40px;
  }
  .pill{
    padding:6px 10px; font-size:12px; border-radius:999px;
    background:linear-gradient(180deg, #aaf3cf, #52ffa8); color:#02140b; font-weight:800;
    letter-spacing:.4px;
  }
  .now .title{font-weight:700; font-size:15px}
  .now .mini{font-size:12px; color:var(--muted)}

  .bar{
    --h:10px; height:var(--h); width:100%; border-radius:999px;
    background:#0c1320; border:1px solid #142035; position:relative; cursor:pointer;
  }
  .bar > .fill{
    position:absolute; inset:0 auto 0 0; width:0%; border-radius:999px;
    background:linear-gradient(90deg, var(--brand), var(--brand-2));
    box-shadow:0 0 14px rgba(76,201,240,.35);
  }
  .time{
    display:flex; justify-content:space-between; font-size:12px; color:#a7c2d6
  }

  .transport{
    display:flex; flex-wrap:wrap; gap:8px
  }
  .tbtn{
    appearance:none; border:1px solid #1a2740; background:#0c1320; color:#d4ecff;
    padding:10px 12px; border-radius:12px; font-weight:700; letter-spacing:.4px; cursor:pointer;
  }
  .tbtn.primary{
    background:linear-gradient(180deg, #9fe7ff, #5fd0ff); color:#031018; border:none;
    box-shadow:0 6px 18px rgba(79,199,240,.3);
  }
  .tbtn:hover{filter:brightness(1.06)}
  .tog.on{outline:2px solid #234876}

  .helper{
    display:flex; gap:14px; flex-wrap:wrap; align-items:center; font-size:12px; color:var(--muted)
  }
  .helper kbd{
    padding:4px 7px; border-radius:6px; border:1px solid #1b2a45; background:#0d1422; color:#c6e4ff;
    box-shadow: inset 0 -2px 0 #0a101a; font-weight:700
  }

  footer{
    margin:28px auto; max-width:1100px; padding:0 18px; color:#9bb4c7; font-size:12px
  }
</style>
</head>
<body>

<header class="topbar">
  <div class="wrap">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div class="title">VOV • <b>BLACKVOX Campeão</b></div>
    </div>
    <nav class="nav">
      <a href="/vov/index.html">Início</a>
      <a href="/vov/vov_players.html">Clássico</a>
      <a href="/vov/vov_mini.html" target="_blank" rel="noopener">Mini</a>
    </nav>
  </div>
</header>

<main class="container">
  <div class="grid">
    <!-- Painel de playlist -->
    <section class="panel">
      <h2>Sua lista</h2>
      <p class="muted">Adicione áudios do seu dispositivo (arraste/solte ou selecione). Reordene, remova e toque.</p>

      <label class="drop" id="drop">
        <input id="fileInput" type="file" accept="audio/*" multiple />
        <strong>Arraste arquivos aqui</strong><br>
        <span class="muted">ou clique para selecionar</span>
      </label>

      <div class="controls">
        <button class="btn" id="btnAdd">Adicionar</button>
        <button class="btn ghost" id="btnClear">Limpar Lista</button>
        <button class="btn warn" id="btnSave">Salvar Playlist</button>
        <button class="btn ghost" id="btnLoad">Carregar Salva</button>
      </div>

      <div id="list" class="list" aria-live="polite"></div>
    </section>

    <!-- Player -->
    <section class="player" aria-label="Reprodutor">
      <div class="now">
        <span class="pill" id="badge">PRONTO</span>
        <div>
          <div class="title" id="nowTitle">Sem faixa selecionada</div>
          <div class="mini" id="nowHint">Adicione arquivos para começar</div>
        </div>
      </div>

      <div class="bar" id="seek">
        <div class="fill" id="fill"></div>
      </div>
      <div class="time"><span id="tNow">0:00</span><span id="tDur">0:00</span></div>

      <div class="transport">
        <button class="tbtn" id="prev">⟨⟨</button>
        <button class="tbtn primary" id="play">► / ❚❚</button>
        <button class="tbtn" id="next">⟩⟩</button>
        <button class="tbtn tog" id="repeat">Loop</button>
        <button class="tbtn tog" id="shuffle">Shuffle</button>
      </div>

      <div class="helper">
        Atalhos: <kbd>Space</kbd> play/pause • <kbd>←/→</kbd> -/+10s • <kbd>↑/↓</kbd> faixa ±
      </div>

      <audio id="audio" preload="metadata"></audio>
    </section>
  </div>
</main>

<footer>
  V O V — Ver • Ouvir • Vender • Viver • Salvador • Amaralina • Brasil
</footer>

<script>
(() => {
  const fileInput = document.getElementById('fileInput');
  const btnAdd = document.getElementById('btnAdd');
  const btnClear = document.getElementById('btnClear');
  const btnSave = document.getElementById('btnSave');
  const btnLoad = document.getElementById('btnLoad');

  const list = document.getElementById('list');
  const audio = document.getElementById('audio');
  const badge = document.getElementById('badge');
  const nowTitle = document.getElementById('nowTitle');
  const nowHint = document.getElementById('nowHint');

  const seek = document.getElementById('seek');
  const fill = document.getElementById('fill');
  const tNow = document.getElementById('tNow');
  const tDur = document.getElementById('tDur');

  const prev = document.getElementById('prev');
  const play = document.getElementById('play');
  const next = document.getElementById('next');
  const repeat = document.getElementById('repeat');
  const shuffle = document.getElementById('shuffle');

  const drop = document.getElementById('drop');

  /** Estado **/
  let tracks = []; // {name, src, file?}
  let current = -1;
  let loopOn = false;
  let shuffleOn = false;

  /** Helpers **/
  const fmt = s => {
    s = Math.max(0, Math.floor(s||0));
    const m = Math.floor(s/60), r = (s%60).toString().padStart(2,'0');
    return `${m}:${r}`;
  };

  const refreshList = () => {
    list.innerHTML = '';
    tracks.forEach((t, i) => {
      const row = document.createElement('div');
      row.className = 'row' + (i===current? ' active':'');
      row.innerHTML = `
        <div class="meta">
          <span class="dot"></span>
          <div class="name" title="${t.name}">${t.name}</div>
        </div>
        <div class="ops">
          <button class="chip" data-op="up" data-i="${i}">↑</button>
          <button class="chip" data-op="down" data-i="${i}">↓</button>
          <button class="chip" data-op="play" data-i="${i}">▶</button>
          <button class="chip" data-op="del" data-i="${i}">×</button>
        </div>
      `;
      list.appendChild(row);
    });
  };

  const setBadge = (txt, tone='ok') => {
    const map = { ok:'linear-gradient(180deg, #aaf3cf, #52ffa8)',
                  warn:'linear-gradient(180deg, #ffe08a, #ffd166)',
                  danger:'linear-gradient(180deg, #ff9aa4, #ff6b6b)' };
    badge.textContent = txt.toUpperCase();
    badge.style.background = map[tone]||map.ok;
  };

  const loadAndPlay = (index) => {
    if (index<0 || index>=tracks.length) return;
    current = index;
    const t = tracks[current];
    audio.src = t.src;
    nowTitle.textContent = t.name;
    nowHint.textContent = `${current+1} / ${tracks.length}`;
    setBadge('tocando');
    refreshList();
    audio.play().catch(()=>{ /* ignore */ });
  };

  const nextIndex = () => {
    if (shuffleOn) {
      let r = Math.floor(Math.random()*tracks.length);
      if (tracks.length>1){
        while (r===current) r = Math.floor(Math.random()*tracks.length);
      }
      return r;
    }
    return (current+1) % tracks.length;
  };

  /** Eventos UI **/
  btnAdd.onclick = () => fileInput.click();
  fileInput.onchange = (e) => {
    const files = [...(e.target.files||[])].filter(f => f.type.startsWith('audio/'));
    files.forEach(f => {
      tracks.push({ name:f.name, src:URL.createObjectURL(f), file:f });
    });
    setBadge('adicionado');
    nowHint.textContent = `${tracks.length} arquivo(s) na lista`;
    if (current===-1 && tracks.length>0) loadAndPlay(0);
    refreshList();
  };

  btnClear.onclick = () => {
    audio.pause(); audio.removeAttribute('src'); audio.load();
    tracks = []; current = -1; refreshList();
    nowTitle.textContent = 'Sem faixa selecionada';
    nowHint.textContent = 'Adicione arquivos para começar';
    setBadge('pronto','warn');
    fill.style.width = '0%'; tNow.textContent='0:00'; tDur.textContent='0:00';
  };

  btnSave.onclick = () => {
    if (!tracks.length) { setBadge('lista vazia','warn'); return; }
    const name = prompt('Nome para salvar esta playlist:','Minha Playlist VOV');
    if (!name) return;
    const payload = tracks.map(t => ({name:t.name}));
    // Salvamos apenas os nomes (sem blobs) para evitar confusão técnica.
    // O objetivo é o usuário lembrar a ordem e reconstruir quando quiser.
    localStorage.setItem('VOV_PLAYLIST_'+name, JSON.stringify(payload));
    setBadge('salvo');
    alert('Playlist salva (nomes/ordem). Para tocar novamente, adicione os mesmos arquivos e use esta referência.');
  };

  btnLoad.onclick = () => {
    const keys = Object.keys(localStorage).filter(k => k.startsWith('VOV_PLAYLIST_'));
    if (!keys.length){ alert('Nenhuma playlist salva.'); return; }
    const names = keys.map(k => k.replace('VOV_PLAYLIST_',''));
    const pick = prompt('Digite o nome exatamente como salvo:\n\n' + names.join('\n'));
    if (!pick) return;
    const raw = localStorage.getItem('VOV_PLAYLIST_'+pick);
    if (!raw){ alert('Não encontrado.'); return; }
    const arr = JSON.parse(raw);
    // Apenas mostra a ordem como guia
    alert('Ordem salva:\n\n' + arr.map((x,i)=> `${i+1}. ${x.name}`).join('\n') + '\n\nDica: adicione os arquivos nesta ordem.');
  };

  list.addEventListener('click', (e) => {
    const btn = e.target.closest('.chip'); if(!btn) return;
    const i = +btn.dataset.i; const op = btn.dataset.op;
    if (op==='play') loadAndPlay(i);
    else if (op==='del'){
      if (i===current){ audio.pause(); }
      tracks.splice(i,1);
      if (tracks.length===0){ current=-1; btnClear.onclick(); return; }
      if (i<current) current--;
      refreshList();
    }
    else if (op==='up' && i>0){
      [tracks[i-1], tracks[i]] = [tracks[i], tracks[i-1]];
      if (current===i) current=i-1; else if (current===i-1) current=i;
      refreshList();
    }
    else if (op==='down' && i<tracks.length-1){
      [tracks[i], tracks[i+1]] = [tracks[i+1], tracks[i]];
      if (current===i) current=i+1; else if (current===i+1) current=i;
      refreshList();
    }
  });

  // Drag & drop
  ;['dragenter','dragover'].forEach(ev => drop.addEventListener(ev, e=>{
    e.preventDefault(); e.stopPropagation(); drop.classList.add('drag');
  }));
  ;['dragleave','drop'].forEach(ev => drop.addEventListener(ev, e=>{
    e.preventDefault(); e.stopPropagation(); drop.classList.remove('drag');
  }));
  drop.addEventListener('drop', e=>{
    const files = [...(e.dataTransfer.files||[])].filter(f=>f.type.startsWith('audio/'));
    files.forEach(f => tracks.push({name:f.name, src:URL.createObjectURL(f), file:f}));
    setBadge('adicionado');
    nowHint.textContent = `${tracks.length} arquivo(s) na lista`;
    if (current===-1 && tracks.length>0) loadAndPlay(0);
    refreshList();
  });

  // Transport
  prev.onclick = () => {
    if (!tracks.length) return;
    const idx = current<=0 ? tracks.length-1 : current-1;
    loadAndPlay(idx);
  };
  next.onclick = () => {
    if (!tracks.length) return;
    const idx = nextIndex();
    loadAndPlay(idx);
  };
  play.onclick = () => {
    if (!tracks.length) return;
    if (current===-1) loadAndPlay(0);
    else if (audio.paused) audio.play();
    else audio.pause();
  };
  repeat.onclick = () => { loopOn = !loopOn; repeat.classList.toggle('on', loopOn); };
  shuffle.onclick = () => { shuffleOn = !shuffleOn; shuffle.classList.toggle('on', shuffleOn); };

  // Seek bar
  const seekTo = (clientX) => {
    const rect = seek.getBoundingClientRect();
    const p = Math.min(1, Math.max(0, (clientX - rect.left)/rect.width));
    audio.currentTime = (audio.duration||0)*p;
  };
  seek.addEventListener('click', e=> seekTo(e.clientX));

  // Audio events
  audio.addEventListener('timeupdate', ()=>{
    if (!isFinite(audio.duration)) return;
    fill.style.width = (audio.currentTime/audio.duration*100)+'%';
    tNow.textContent = fmt(audio.currentTime);
    tDur.textContent = isFinite(audio.duration) ? fmt(audio.duration) : '0:00';
  });
  audio.addEventListener('play', ()=> setBadge('tocando'));
  audio.addEventListener('pause', ()=> setBadge('pausado','warn'));
  audio.addEventListener('ended', ()=>{
    if (loopOn){ audio.currentTime=0; audio.play(); return; }
    if (!tracks.length) return;
    loadAndPlay(nextIndex());
  });
  audio.addEventListener('loadedmetadata', ()=>{
    tDur.textContent = isFinite(audio.duration) ? fmt(audio.duration) : '0:00';
  });

  // Keys
  window.addEventListener('keydown', (e)=>{
    if (['INPUT','TEXTAREA'].includes((e.target.tagName||''))) return;
    if (e.code==='Space'){ e.preventDefault(); play.onclick(); }
    else if (e.key==='ArrowRight'){ audio.currentTime+=10; }
    else if (e.key==='ArrowLeft'){ audio.currentTime-=10; }
    else if (e.key==='ArrowUp'){ prev.onclick(); }
    else if (e.key==='ArrowDown'){ next.onclick(); }
  });
})();
</script>
</body>
</html>
